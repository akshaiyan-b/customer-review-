Todo:
- Documentation.
- write to CSV.
- better logging.